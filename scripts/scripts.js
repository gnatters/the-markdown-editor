!function(){"use strict";var a;a=angular.module("mdApp",["ngResource"]).config(["$httpProvider",function(a){return a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),_.kill_event=function(a){return a.cancelBubble=!0,a.stopPropagation(),a.preventDefault()},_.corsproxy=function(a){var b;return b=a.match(/https?:\/\/(.+)/),b?"http://www.corsproxy.com/"+b[1]:!1}}.call(this),function(){"use strict";angular.module("mdApp").service("dndFile",["$rootScope",function(){var a,b,c,d=this;return a=/\.(md|litcoffee|css)$/,c=function(a,b){var c,e;return(c=function(){var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],b.test(c.name))return c}())?(e=new FileReader,e.onload=function(a){return a.fileName=c.name.replace(b,""),a.fileExt=c.name.match(b)[1],d.callbacks.fileload(a)},e.readAsText(c)):void 0},b=function(a){var b;return b=a.dataTransfer.files,b.length?(c(b,/\.(md|litcoffee)$/),c(b,/\.(css)$/)):void 0},this.callbacks={active:function(){},inactive:function(){},fileload:function(){},drop:function(){},default_drop:b},{init:function(a){return a.addEventListener("dragenter",function(a){return _.kill_event(a),d.callbacks.active(a)}),a.addEventListener("dragover",function(a){return _.kill_event(a),d.callbacks.active(a)}),a.addEventListener("dragexit",function(a){return _.kill_event(a),d.callbacks.inactive(a)}),a.addEventListener("drop",function(a){return _.kill_event(a),d.callbacks.drop(a),d.callbacks.default_drop(a)})},onactive:function(a){return d.callbacks.active=a},oninactive:function(a){return d.callbacks.inactive=a},onfileload:function(a){return d.callbacks.fileload=a},ondrop:function(a,c){return d.callbacks.drop=a,d.callbacks.default_drop=c?function(){}:b}}}])}.call(this),function(){"use strict";angular.module("mdApp").filter("md2html",function(){return function(a){return a&&a.length?markdown.toHTML(a):""}}).filter("scopeCSS",["$filter",function(){return function(a,b){var c,d,e,f,g;return d=document.implementation.createHTMLDocument(""),g=document.createElement("style"),g.innerText=a,d.body.appendChild(g),c=/(^| )(head|title|link|style|script)($| )/,e="",f=function(a){var d,g,h,i,j,k,l;if(a.length){for(l=[],d=j=0,k=a.length;k>=0?k>j:j>k;d=k>=0?++j:--j)a[d].selectorText?(i=a[d].selectorText.split(", "),h=function(){var a,d,e;for(e=[],a=0,d=i.length;d>a;a++)g=i[a],c.test(g)||e.push(/(^| )(body|html)($| )/.test(g)?g.replace(/(body|html)/,b):""+b+" "+g);return e}().join(", "),h?(a[d].selectorText=h,l.push(e+=a[d].cssText+" ")):l.push(void 0)):"screen"===a[d].media[0]?l.push(f(a[d].cssRules)):l.push(void 0);return l}},f(g.sheet.cssRules),e}}]).filter("prettifyCSS",function(){return function(a){return a.replace(/^\s+/g,"").replace(/\s*,\s*/g,", ").replace(/\s*{\s*/g," {\n  ").replace(/\s*;\s*/g,";\n  ").replace(/\*\//g,"*/\n").replace(/\n\n+/g,"\n").replace(/\s*}\s*/g,"\n}\n\n")}}).filter("prettifyHTML",function(){var a,b,c,d,e;return c=function(a,b){return 0>=a?"":Array(a-b+1).join("  ")},d=function(a){return"span"===a||"a"===a||"code"===a||"i"===a||"b"===a||"em"===a||"strong"===a||"abbr"===a||"img"===a||"h1"===a||"h2"===a||"h3"===a||"h4"===a||"h5"===a||"h6"===a||"bdi"===a||"bdo"===a||"wbr"===a||"kbd"===a||"del"===a||"ins"===a||"s"===a||"rt"===a||"rp"===a||"var"===a||"time"===a||"sub"===a||"sup"===a||"link"===a||"title"===a||"label"===a||"input"===a},a=function(a){return"area"===a||"br"===a||"col"===a||"embed"===a||"hr"===a||"img"===a||"input"===a||"keygen"===a||"link"===a||"meta"===a||"base"===a||"param"===a||"source"===a||"track"===a||"wbr"===a},b=function(a){var b;return function(){var c,e,f;for(f=[],c=0,e=a.length;e>c;c++)b=a[c],d(b)&&f.push(b);return f}().length},e="<(?:(?:(\\w+)[^><]*?)|(?:\\/(\\w+)))>",e=new RegExp(e),e.compile(e),function(f){var g,h,i,j,k,l,m,n;for(l=f,h=0,m=[],k="";f;)g=f.search(e),g+1||(k+=f,f=""),j=f.match(e),(n=j[1])?d(n)?("\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=f.substr(0,g+j[0].length),m.push(n),h+=1,f=f.substr(g+j[0].length)):a(n)?("\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=f.substr(0,g+j[0].length),f=f.substr(g+j[0].length)):(g&&"\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),k+=""+f.substr(0,g),"\n"!==k.charAt(k.length-1)&&(k+="\n"),k+=c(m.length,h)+j[0],m.push(n),k+="\n",f=f.substr(g+j[0].length)):(n=j[2])?(i=m.lastIndexOf(n),i+1?d(n)?(h-=1,m.splice(i),k+=""+f.substr(0,g)+j[0],f=f.substr(g+j[0].length)):(g&&"\n"===k.charAt(k.length-1)&&(k+=c(m.length,h)),m.splice(i),h=b(m),k+=""+f.substr(0,g)+("\n"===k.charAt(k.length-1)?"":"\n")+c(m.length,h)+j[0],f=f.substr(g+j[0].length),"\n"!==f[0]&&(k+="\n")):(k+=""+f.substr(0,g+j[0].length),f=f.substr(g+j[0].length))):console.warn("UH OH: found a tag that's not an opening tag or a closing tag!?!?");return k}})}.call(this),function(){"use strict";var a;a="The Markdown Editor\n===\n\n* Edit's made on the left panel instantly render on the right\n* Drag the middle divider to resize panels\n* Drag and drop a `.md` or `.litcoffee` file into this window to load it\n* <span style='color:pink; background-color:darkred; padding:5px; border-radius:8px'>HTML is allowed too!</span>\n",angular.module("mdApp").controller("mdCtrl",["$scope","$http","$element","dndFile","$filter",function(b,c,d,e,f){return b.md_raw=a,b.dragover=!1,e.init(d[0],e.onactive(function(){return b.$apply(function(){return b.dragover=!0})})),e.oninactive(function(){return b.$apply(function(){return b.dragover=!1})}),d[0].addEventListener("mousemove",function(){return b.$apply(function(){return b.dragover=!1})}),e.ondrop(function(){return b.$apply(function(){return b.dragover=!1})},!1),e.onfileload(function(a){return b.$apply(function(){var c,d,e;if("md"===(e=a.fileExt)||"litcoffee"===e)return b.md_raw=a.target.result;if("css"===a.fileExt){for(d=a.fileName,c=0;d in b.style.sheets;)d=""+a.fileName+" "+ ++c;return b.style.sheets[d]={source:"dragged file","native":!1,css:a.target.result},b.style.active=d}})}),d.bind("click",function(){return b.$broadcast("ctrlClicked")}),b.style={active:"markdowncss",sheets:{markdowncss:{source:_.corsproxy("http://kevinburke.bitbucket.org/markdowncss/markdown.css"),"native":!0},GitHub:{source:"styles/md/github.css","native":!0}},external:"",editor:""},b.copy_style=function(a,c){var d,e,f;for(_.kill_event(a),d=_.clone(b.style.sheets[c]),c=c.match(/(.*?)(:? copy(:? \d+)?)?$/)[1],f=""+c+" copy",e=0;f in b.style.sheets;)f=""+c+" copy "+ ++e;return d["native"]=!1,b.style.sheets[f]=d,b.style.active=f},b.delete_style=function(a,c){return _.kill_event(a),delete b.style.sheets[c],b.style.active===c?b.style.active=Object.keys(b.style.sheets)[0]:void 0},b.$watch("style.active",function(){var a;return b.style.active in b.style.sheets?(a=b.style.sheets[b.style.active],a.css?b.style.editor=f("prettifyCSS")(a.css):c.get(a.source).then(function(c){return a.css=c.data,b.style.editor=f("prettifyCSS")(a.css)})):void 0}),b.$watch("style.editor",function(){return b.style.sheets[b.style.active].css=b.style.editor}),b.$watch("style.external",function(){return b.style.external&&/^(https?:\/\/)?(\w+\.)+[\w\/]+/.test(b.style.external)?c.get(_.corsproxy(b.style.external)).then(function(a){var c,d,e;for(d=0,c=b.style.external.match(/.+?\/(\w+)\.css/),e=c&&c[1]||"external";e in b.style.sheets;)e="external "+ ++d;return b.style.sheets[e]={source:b.style.external,css:a.data,external:!0,edited:!1},b.style.active=e,b.style.external=""}):void 0}),b.message="",b.$watch("message",function(){var a;return a=new Date,setTimeout(function(){return b.$apply(function(){return new Date-a>=5e3?b.message="":void 0})},5e3)})}])}.call(this),function(){"use strict";angular.module("mdApp").directive("adjustableRow",function(){return{restrict:"E",transclude:!0,scope:{},replace:!0,template:'<div class="adjustable-row" ng-transclude></div>',controller:["$scope","$element","$compile",function(a,b,c){var d,e,f,g=this;return a.row=b[0],d=a.$parent.cols=a.cols=[],this.equalCols=function(a){var b,c,e,g,h;for(a||(a=function(){var a,c,e;for(e=[],a=0,c=d.length;c>a;a++)b=d[a],b.show&&e.push(b);return e}().length),c=1/a,h=[],e=0,g=d.length;g>e;e++)b=d[e],b.show?(b.ratio=c,b.percentage=""+100*c+"%",h.push(b.right_percentage=f(b.index))):(b.ratio=0,b.percentage="0%",h.push(b.right_percentage=f(b.index)));return h},this.findLastCol=function(){var a,b,c,e;for(b=null,c=0,e=d.length;e>c;c++)a=d[c],a.last_shown=!1,a.show&&(b=a);return b?b.last_shown=!0:void 0},this.addCol=function(b){var e=this;return a.$apply(function(){return b.index=d.length,d.push(b),e.equalCols(),b.div.append(c('<dragarea ng-show="!last_shown"></dragarea>')(b))})},f=function(a){var b;return""+100*function(){var c,e,f;for(f=[],c=0,e=d.length;e>c;c++)b=d[c],b.index<=a&&f.push(b.ratio);return f}().reduce(function(a,b){return a+b},0)+"%"},e=function(b){return a.$apply(function(){var c,e,h,i,j;for(e=a.dragging,c=d[j=e.index+1];!c.show;)c=d[++j];return i=function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)h=d[a],h.index<e.index&&c.push(h.ratio);return c}().reduce(function(a,b){return a+b},0),e.ratio=b/g.row_width-i,e.ratio<.1&&(e.ratio=.1),c.ratio=1-function(){var a;a=[];for(j in d)parseInt(j)!==c.index&&a.push(d[j].ratio);return a}().reduce(function(a,b){return a+b},0),c.ratio<.1&&(c.ratio=.1,e.ratio=1-function(){var a;a=[];for(j in d)parseInt(j)!==e.index&&a.push(d[j].ratio);return a}().reduce(function(a,b){return a+b},0)),e.percentage=""+100*e.ratio+"%",c.percentage=""+100*c.ratio+"%",e.right_percentage=f(e.index)})},(window.onresize=function(){return g.row_width=a.row.offsetWidth})(),this.start_drag=function(b,c){return _.kill_event(c),a.dragging=b},document.onmousemove=function(b){return _.kill_event(b),a.dragging?e(b.clientX):void 0},document.onmouseup=function(){return a.dragging=null}}]}}).directive("adjustablecol",function(){return{require:"^adjustableRow",restrict:"E",transclude:!0,scope:{name:"@",show:"@"},replace:!0,template:'<div class="adjustable-col" ng-transclude ng-style="{width: percentage}" ng-show="show"></div>',controller:["$scope",function(a){return a.$watch("show",function(){return a.ctrl.equalCols(),a.ctrl.findLastCol()})}],link:function(a,b,c,d){return a.div=b,a.ctrl=d,setTimeout(function(){return a.show=!!a.show,d.addCol(a)},0)}}}).directive("dragarea",function(){return{restrict:"E",replace:!0,template:'<div class="dragarea" ng-style="{left: right_percentage}">፧</div>',scope:!1,link:function(a,b){return b.bind("mousedown",function(b){return a.ctrl.start_drag(a,b)})}}}).controller("menuCtrl",["$scope","$element","$rootScope",function(a,b,c){return a.show=!1,a.$on("ctrlClicked",function(){return a.$apply(function(){return a.show=!1})}),b[0].children[0].addEventListener("click",function(b){var d;return _.kill_event(b),d=a.show=!a.show,c.$broadcast("ctrlClicked"),a.$apply(function(){return a.show=d})})}]).directive("themeMenu",["$rootScope",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div id="theme-menu" class="menu"><span class="menu-title">Themes ▾</span><ul class="menu-items" ng-class="{in:show}"><li class="menu-item" ng-repeat="(style, props) in style.sheets" ng-click="$parent.style.active=style" ng-class="{active_style:$parent.style.active==style}">{{style}}<ul class="menu-actions"><li class="icon-trash" ng-click="!props.native && delete_style($event, style)" ng-class="{inactive:props.native}" title="Delete styles"></li><li class="icon-copy" ng-click="copy_style($event, style)" title="Duplicate styles"></li><li class="icon-save" ng-show="false" title="Save styles"></li></ul></li><li class="menu-item" ng-click="select_ext($event)" ng-class="{active_style:style.active==\'external\'}"><label for="external-css">External: </label><input id="styles_external" ng-model="style.external"  ng-keydown="keydown_input($event)" type="text" name="external-css" id="external-css" placeholder="http://"></li></ul></div>',controller:"menuCtrl",link:function(a){return a.select_ext=function(a){return _.kill_event(a),styles_external.focus()},styles_external.onkeydown=function(b){return 13===(b.which||b.keyCode)?a.$apply(function(){return a.show=!1}):void 0}}}}]).directive("viewMenu",["$rootScope",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div id="view-menu" class="menu"><span class="menu-title">View ▾</span><ul class="menu-items" ng-class="{in:show}"><li class="menu-item" ng-repeat="col in cols" ng-class="{active_col:col.show}" ng-click="col.show=!col.show">{{col.name}}</li></ul></div>',controller:"menuCtrl"}}]).directive("forkme",function(){return{restrict:"E",replace:!0,template:'<a id="forkme-ribbon" href="https://github.com/gnatters/the-markdown-editor"><img src="images/forkme.png" alt="Fork me on GitHub"></a>',link:function(a,b){return b.bind("mousedown",function(a){return a.preventDefault()})}}})}.call(this);